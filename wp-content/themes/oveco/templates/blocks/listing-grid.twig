{# Listing Grid - Template Twig #}
<section {{ wrapper_attributes|raw }} class="listing-grid listing-grid--cols-{{ attributes.layout.cols|default(3) }} listing-grid--gap-{{ attributes.layout.gap|default('medium') }}" id="{{ block_id }}">
  {% if posts %}
    <div class="listing-grid__container">
      <div class="listing-grid__grid">
        {% for post in posts %}
          <article class="listing-grid__item">
            {% if template_exists('partials/_card.twig') %}
              {% include 'partials/_card.twig' with { post: post } %}
            {% else %}
              {# Carte minimale par défaut #}
              <div class="listing-grid__card card">
                {% if post.thumbnail %}
                  <div class="card__media">
                    <img src="{{ post.thumbnail.src('medium') }}" alt="{{ post.thumbnail.alt }}" class="card__image" loading="lazy" />
                  </div>
                {% endif %}
                
                <div class="card__content">
                  <h3 class="card__title">
                    <a href="{{ post.link }}" class="card__link">{{ post.title }}</a>
                  </h3>
                  
                  {% if post.excerpt %}
                    <p class="card__excerpt">{{ post.excerpt }}</p>
                  {% endif %}
                  
                  <div class="card__meta">
                    <time class="card__date" datetime="{{ post.date('c') }}">
                      {{ post.date('d/m/Y') }}
                    </time>
                    
                    {% if post.post_type == 'post' and post.categories %}
                      <div class="card__categories">
                        {% for category in post.categories %}
                          <span class="card__category">{{ category.name }}</span>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endif %}
          </article>
        {% endfor %}
      </div>
      
      {% if attributes.showPagination and query.max_num_pages > 1 %}
        <div class="listing-grid__pagination">
          {# Pagination sera générée par WordPress si nécessaire #}
        </div>
      {% endif %}
    </div>
  {% else %}
    <div class="listing-grid__empty">
      <p class="listing-grid__empty-message">
        Aucun contenu trouvé pour les critères sélectionnés.
      </p>
    </div>
  {% endif %}
</section>