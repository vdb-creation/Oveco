---
/**
 * Composant: Autoconstruction
 * Section présentant les services d'accompagnement à l'auto-construction
 * Compatible TinaCMS via props
 */

import SmartImage from './SmartImage.astro';

export interface AutoconstructionService {
  image: string;
  alt: string;
  title: string;
  description: string;
}

export interface Props {
  subtitle?: string;
  title?: string;
  description?: string;
  services?: AutoconstructionService[];
  ctaLabel?: string;
  ctaHref?: string;
}

const {
  subtitle = "l'auto-construction",
  title = "Apprendre en faisant, construire en étant accompagné",
  description = "Nous croyons que l'auto-construction est un moyen puissant de s'approprier son habitat. En vous formant, en vous conseillant et en vous fournissant les bons outils, nous vous permettons de participer activement aux installations en toute sécurité.",
  services = [
    {
      image: "/uploads/hero/maison-build.png",
      alt: "Accompagnement personnalisé pour l'auto-construction",
      title: "Accompagnement sur mesure",
      description: "Chaque projet est unique : nous adaptons nos conseils, nos formations et nos outils à vos compétences et vos objectifs."
    },
    {
      image: "/uploads/hero/maison-toit.png",
      alt: "Formation et transmission de savoir-faire",
      title: "Formation et transmission",
      description: "Des sessions de formation sont prévues avant les étapes clés du chantier. Vous devenez autonome tout en étant épaulé."
    },
    {
      image: "/uploads/hero/maison-toit-2.png",
      alt: "Matériel professionnel pour l'auto-construction",
      title: "Matériel professionnel accessible",
      description: "Nous vous proposons les équipements professionnels à prix préférentiels, avec livraison et support technique."
    }
  ],
  ctaLabel = "En savoir plus",
  ctaHref = "#contact"
} = Astro.props;
---

<section class="autoconstruction-section" id="autoconstruction" itemscope itemtype="https://schema.org/Service">
  <div class="autoconstruction">
    <div class="autoconstruction__container">
      <header class="autoconstruction__header">
        <p class="autoconstruction__subtitle">{subtitle}</p>
        <h2 class="autoconstruction__title" itemprop="name" set:html={title} />
        <p class="autoconstruction__description" itemprop="description" set:html={description} />
      </header>

      <div class="autoconstruction__content">
        <div class="autoconstruction__services" role="list" aria-labelledby="autoconstruction-title">
          {services.map((service) => (
            <article class="autoconstruction__service" role="listitem" itemscope itemtype="https://schema.org/Service">
              <SmartImage
                cmsSrc={service.image}
                alt={service.alt}
                width={400}
                height={300}
                context="about"
                loading="lazy"
                class="autoconstruction__service-image"
              />
              <div class="autoconstruction__service-content">
                <h3 class="autoconstruction__service-title" itemprop="name">{service.title}</h3>
                <p class="autoconstruction__service-description" itemprop="description">
                  {service.description}
                </p>
              </div>
            </article>
          ))}
        </div>

        <a href={ctaHref} class="autoconstruction__cta" aria-label={`${ctaLabel} sur l'auto-construction`}>
          <span>{ctaLabel}</span>
        </a>
      </div>
    </div>
  </div>
</section>

<style>
/* CSS extrait de wp-content/themes/oveco/style.css (autoconstruction section) */
.autoconstruction-section {
  padding: clamp(50px, 8vw, 90px) clamp(16px, 6vw, 109px);
  overflow: hidden;
  background: #FFFEF8;
  width: 100%;
  max-width: 100vw;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.autoconstruction__container {
  width: 100%;
  max-width: 1214px;
  margin: 0 auto;
  box-sizing: border-box;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: clamp(30px, 5vw, 72px);
  display: flex;
}

.autoconstruction__header {
  width: 842px;
  max-width: 100%;
  box-sizing: border-box;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: 10px;
  display: flex;
}

@media (max-width: 1024px) {
  .autoconstruction__header {
    width: 100%;
    max-width: 700px;
    padding: 0 20px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__header {
    width: 100%;
    max-width: 600px;
    padding: 0 15px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__header {
    width: 100%;
    max-width: 500px;
    padding: 0 10px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__header {
    width: 100%;
    padding: 0 5px;
  }
}

.autoconstruction__subtitle {
  text-align: center;
  color: #5C6D6F;
  font-size: 19.2px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  line-height: 20px;
  letter-spacing: 1.92px;
  margin: 0;
}

@media (max-width: 1024px) {
  .autoconstruction__subtitle {
    font-size: 18px;
    letter-spacing: 1.7px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__subtitle {
    font-size: 17px;
    letter-spacing: 1.5px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__subtitle {
    font-size: 16px;
    letter-spacing: 1.3px;
    line-height: 18px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__subtitle {
    font-size: 14px;
    line-height: 16px;
    letter-spacing: 1px;
  }
}

.autoconstruction__title {
  align-self: stretch;
  text-align: center;
  color: #334749;
  font-size: 39.81px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 800;
  line-height: 47.77px;
  margin: 0;
}

@media (max-width: 1024px) {
  .autoconstruction__title {
    font-size: 36px;
    line-height: 42px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__title {
    font-size: 32px;
    line-height: 38px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__title {
    font-size: 28px;
    line-height: 34px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__title {
    font-size: 24px;
    line-height: 28px;
  }
}

.autoconstruction__description {
  align-self: stretch;
  text-align: center;
  color: #5C6D6F;
  font-size: 16px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 400;
  line-height: 28.8px;
  margin: 0;
}

@media (max-width: 1024px) {
  .autoconstruction__description {
    font-size: 15.5px;
    line-height: 27px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__description {
    font-size: 15px;
    line-height: 26px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__description {
    font-size: 14.5px;
    line-height: 25px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__description {
    font-size: 14px;
    line-height: 22px;
  }
}

.autoconstruction__content {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: 42px;
  display: flex;
  overflow: hidden;
}

@media (max-width: 1012px) {
  .autoconstruction__content {
    gap: 35px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__content {
    gap: 30px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__content {
    gap: 35px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__content {
    gap: 30px;
  }
}

.autoconstruction__services {
  width: 100%;
  max-width: 100%;
  justify-content: center;
  align-items: flex-start;
  gap: clamp(15px, 4vw, 61px);
  display: flex;
  flex-wrap: wrap;
  overflow: hidden;
}

.autoconstruction__service {
  flex: 1 1 320px;
  width: 100%;
  max-width: 364px;
  box-sizing: border-box;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: 24px;
  display: flex;
}

@media (max-width: 768px) {
  .autoconstruction__service {
    max-width: 400px;
  }
}

.autoconstruction__service-image {
  width: 100%;
  max-width: 287px;
  margin-inline: auto;
  aspect-ratio: 287/161;
  border-radius: 24px;
  overflow: hidden;
  object-fit: cover;
  display: block;
}

.autoconstruction__service-content {
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: 8px;
  display: flex;
}

.autoconstruction__service-title {
  width: 324px;
  max-width: 100%;
  text-align: center;
  color: #334749;
  font-size: 27.65px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 800;
  line-height: 30.42px;
  margin: 0;
}

@media (max-width: 1200px) {
  .autoconstruction__service-title {
    width: 280px;
    font-size: 26px;
    line-height: 29px;
  }
}

@media (max-width: 1100px) {
  .autoconstruction__service-title {
    width: 260px;
    font-size: 24px;
    line-height: 27px;
  }
}

@media (max-width: 1012px) {
  .autoconstruction__service-title {
    width: 240px;
    font-size: 22px;
    line-height: 25px;
  }
}

@media (max-width: 950px) {
  .autoconstruction__service-title {
    width: 100%;
    font-size: 25px;
    line-height: 28px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__service-title {
    width: 100%;
    font-size: 23px;
    line-height: 26px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__service-title {
    font-size: 20px;
    line-height: 24px;
  }
}

.autoconstruction__service-description {
  width: 364px;
  max-width: 100%;
  text-align: center;
  color: #5C6D6F;
  font-size: 16px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 400;
  line-height: 28.8px;
  margin: 0;
}

@media (max-width: 1200px) {
  .autoconstruction__service-description {
    width: 320px;
    font-size: 15.5px;
    line-height: 27px;
  }
}

@media (max-width: 1100px) {
  .autoconstruction__service-description {
    width: 280px;
    font-size: 15px;
    line-height: 26px;
  }
}

@media (max-width: 1012px) {
  .autoconstruction__service-description {
    width: 260px;
    font-size: 14.5px;
    line-height: 25px;
  }
}

@media (max-width: 950px) {
  .autoconstruction__service-description {
    width: 100%;
    font-size: 15px;
    line-height: 26px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__service-description {
    width: 100%;
    font-size: 14.5px;
    line-height: 25px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__service-description {
    font-size: 14px;
    line-height: 23px;
  }
}

.autoconstruction__cta {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 18px 30px;
  background: #334749;
  border-radius: 30px;
  text-decoration: none;
  transition: all 0.3s ease;
  color: #FFFEF8;
  font-size: 19.2px;
  font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif;
  font-weight: 700;
  line-height: 23.04px;
  border: none;
  cursor: pointer;
}

.autoconstruction__cta:hover {
  background: #2a3a3c;
  transform: translateY(-2px);
}

.autoconstruction__cta:focus {
  outline: 2px solid #048B9A;
  outline-offset: 4px;
}

@media (max-width: 1024px) {
  .autoconstruction__cta {
    padding: 17px 28px;
    font-size: 18px;
    line-height: 21px;
  }
}

@media (max-width: 900px) {
  .autoconstruction__cta {
    padding: 16px 26px;
    font-size: 17px;
    line-height: 20px;
  }
}

@media (max-width: 768px) {
  .autoconstruction__cta {
    padding: 15px 24px;
    font-size: 16px;
    line-height: 19px;
  }
}

@media (max-width: 480px) {
  .autoconstruction__cta {
    padding: 14px 20px;
    font-size: 15px;
    line-height: 18px;
  }
}

@media (prefers-reduced-motion: reduce) {
  .autoconstruction__cta {
    transition: none !important;
  }
  .autoconstruction__cta:hover {
    transform: none !important;
  }
}
</style>
