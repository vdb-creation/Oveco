---
/**
 * Composant: Expertise
 * Section présentant les expertises techniques d'Oveco
 * Compatible TinaCMS via props
 */

import SmartImage from './SmartImage.astro';

export interface ExpertiseCard {
  icon: string;
  alt: string;
  title: string;
  description: string;
}

export interface Props {
  subtitle?: string;
  title?: string;
  description?: string;
  cards?: ExpertiseCard[];
  ctaLabel?: string;
  ctaHref?: string;
  sectionIndex?: number;
}

const {
  subtitle = "Nos expertises",
  title = "Mettre la technique au service de projets humains et durables",
  description = "Chez Oveco, la technique n'est jamais un but en soi, mais un moyen de rendre l'habitat plus autonome, plus confortable et plus durable. Grâce à une expertise de terrain et une veille constante sur les innovations, nous concevons des systèmes sobres, robustes et performants, adaptés à chaque projet.",
  cards = [
    {
      icon: "/uploads/icons/eolienne.png",
      alt: "Icône énergies renouvelables - pompes à chaleur et panneaux solaires",
      title: "Énergies renouvelables",
      description: "Pompes à chaleur, chaudières, panneaux solaires…<br/>Des systèmes performants, bien dimensionnés, pour plus d'autonomie."
    },
    {
      icon: "/uploads/icons/clim.png",
      alt: "Icône confort thermique - systèmes de chauffage et ventilation",
      title: "Confort thermique<br/>& ventilation",
      description: "Chauffage, ventilation, planchers chauffants…<br/>Un confort constant avec une gestion efficace de l'air."
    },
    {
      icon: "/uploads/icons/elec.png",
      alt: "Icône électricité - installation électrique et traitement de l'eau",
      title: "Électricité & traitement de l'eau",
      description: "Électricité, boucles de chaleur, adoucisseurs…<br/>Une gestion durable de vos ressources énergétiques et hydrauliques."
    }
  ],
  ctaLabel = "Découvrir toutes nos expertises",
  ctaHref = "#expertises-details",
  sectionIndex = 0
} = Astro.props;
---

<section class="expertise-section" id="expertises" aria-labelledby="expertise-title">
  <div class="container">
    <div class="expertise__container">
      <header class="expertise__header">
        <h3 class="expertise__subtitle" aria-label="Section nos expertises" data-bind={`sections.${sectionIndex}.subtitle`}>{subtitle}</h3>
        <h2 class="expertise__title" id="expertise-title" data-bind={`sections.${sectionIndex}.title`}>{title}</h2>
        <p class="expertise__description" set:html={description} data-bind={`sections.${sectionIndex}.description`} />
      </header>
      
      <div class="expertise__content">
        <div class="expertise__grid" role="list" aria-label="Liste de nos expertises">
          {(cards?.length ?? 0) === 0 ? (
            <div class="expertise__empty" data-bind={`sections.${sectionIndex}.cards`}>
              <p class="expertise__empty-text">Ajouter une carte d'expertise dans TinaCMS</p>
            </div>
          ) : (
            cards.map((card, index) => (
              <article class="expertise__card" role="listitem" itemscope itemtype="https://schema.org/Service">
                <SmartImage
                  cmsSrc={card.icon}
                  alt={card.alt}
                  width={168}
                  height={168}
                  context="default"
                  loading="lazy"
                  class="expertise__icon"
                  data-bind={`sections.${sectionIndex}.cards.${index}.icon`}
                />
                <div class="expertise__card-content">
                  <h4 class="expertise__card-title" itemprop="name" data-bind={`sections.${sectionIndex}.cards.${index}.title`} set:html={card.title} />
                  <p class="expertise__card-description" itemprop="description" data-bind={`sections.${sectionIndex}.cards.${index}.description`} set:html={card.description} />
                </div>
              </article>
            ))
          )}
        </div>
        
        <a href={ctaHref} class="expertise__cta" aria-label={`${ctaLabel}`}>
          <span>{ctaLabel}</span>
        </a>
      </div>
    </div>
  </div>
</section>

<style>
/* CSS extrait de wp-content/themes/oveco/style.css (main) */
.expertise-section { align-self: stretch; padding: clamp(48px, 8vw, 90px) clamp(16px, 6vw, 109px); overflow: hidden; background: #FFFEF8; }
@media (max-width: 1200px) { .expertise-section { padding: 80px 60px; } }
@media (max-width: 1024px) { .expertise-section { padding: 70px 40px; } }
@media (max-width: 768px) { .expertise-section { padding: 60px 2rem; } }
@media (max-width: 480px) { .expertise-section { padding: 40px 1rem; } }

.expertise__container { width: 100%; max-width: 1214px; margin: 0 auto; flex-direction: column; justify-content: flex-start; align-items: center; gap: clamp(30px, 5vw, 72px); display: flex; }
@media (max-width: 768px) { .expertise__container { gap: 50px; } }
@media (max-width: 480px) { .expertise__container { gap: 40px; } }
.expertise__header { width: min(100%, 706.82px); flex-direction: column; justify-content: flex-start; align-items: center; gap: 10px; display: flex; }
.expertise__subtitle { text-align: center; color: #5C6D6F; font-size: 19.2px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 700; text-transform: uppercase; line-height: 20px; letter-spacing: 1.92px; margin: 0; }
@media (max-width: 768px) { .expertise__subtitle { font-size: 17px; letter-spacing: 1.5px; } }
@media (max-width: 480px) { .expertise__subtitle { font-size: 15px; line-height: 18px; letter-spacing: 1.2px; } }
.expertise__title { align-self: stretch; text-align: center; color: #334749; font-size: 39.81px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 800; line-height: 47.77px; margin: 0; }
@media (max-width: 768px) { .expertise__title { font-size: 32px; line-height: 38px; } }
@media (max-width: 480px) { .expertise__title { font-size: 26px; line-height: 30px; } }
.expertise__description { align-self: stretch; text-align: center; color: #5C6D6F; font-size: 16px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 400; line-height: 28.8px; margin: 0; }
@media (max-width: 768px) { .expertise__description { font-size: 15px; line-height: 26px; } }
@media (max-width: 480px) { .expertise__description { font-size: 14px; line-height: 24px; } }
.expertise__content { align-self: stretch; flex-direction: column; justify-content: flex-start; align-items: center; gap: 42px; display: flex; }
@media (max-width: 480px) { .expertise__content { gap: 30px; } }
.expertise__grid { align-self: stretch; justify-content: center; align-items: flex-start; gap: clamp(20px, 5vw, 61px); display: flex; flex-wrap: wrap; }
@media (max-width: 1200px) { .expertise__grid { gap: 40px; } }
@media (max-width: 1024px) { .expertise__grid { gap: 30px; } }
@media (max-width: 768px) { .expertise__grid { flex-direction: column; align-items: center; gap: 40px; } }
@media (max-width: 480px) { .expertise__grid { gap: 30px; } }
.expertise__card { flex: 1 1 300px; max-width: 364px; flex-direction: column; justify-content: flex-start; align-items: center; gap: 24px; display: flex; }
@media (max-width: 1200px) { .expertise__card { width: clamp(280px, 30vw, 340px); } }
@media (max-width: 1024px) { .expertise__card { width: clamp(260px, 28vw, 320px); } }
@media (max-width: 768px) { .expertise__card { width: 100%; max-width: 500px; } }
@media (max-width: 480px) { .expertise__card { max-width: 350px; gap: 20px; } }
.expertise__icon { width: 168px; height: 168px; margin: 0; display: flex; align-items: center; justify-content: center; }
.expertise__icon img { width: 100% !important; height: 100% !important; object-fit: contain; display: block; mix-blend-mode: multiply; }
@media (max-width: 768px) { .expertise__icon { width: 140px; height: 140px; } }
@media (max-width: 480px) { .expertise__icon { width: 120px; height: 120px; } }
.expertise__card-content { flex-direction: column; justify-content: flex-start; align-items: center; gap: 8px; display: flex; }
.expertise__card-title { width: 324px; text-align: center; color: #334749; font-size: 27.65px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 800; line-height: 30.42px; margin: 0; }
@media (max-width: 768px) { .expertise__card-title { width: 100%; font-size: 24px; line-height: 28px; } }
@media (max-width: 480px) { .expertise__card-title { font-size: 20px; line-height: 24px; } }
.expertise__card-description { width: 364px; text-align: center; color: #5C6D6F; font-size: 16px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 400; line-height: 28.8px; margin: 0; }
@media (max-width: 768px) { .expertise__card-description { width: 100%; font-size: 15px; line-height: 26px; } }
@media (max-width: 480px) { .expertise__card-description { font-size: 14px; line-height: 22px; } }
.expertise__cta { display: flex; justify-content: center; align-items: center; }
.expertise__cta .wp-block-button__link { padding: 18px 30px; background: #334749; border-radius: 30px; text-decoration: none; transition: all 0.3s ease; color: #FFFEF8; font-size: 19.2px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; font-weight: 700; line-height: 23.04px; }
.expertise__cta .wp-block-button__link:hover { background: #2a3a3c; transform: translateY(-2px); }
.expertise__cta .wp-block-button__link:focus { outline: 2px solid #048B9A; outline-offset: 2px; }
@media (max-width: 768px) { .expertise__cta .wp-block-button__link { padding: 16px 28px; font-size: 17px; line-height: 20px; } }
@media (max-width: 480px) { .expertise__cta .wp-block-button__link { padding: 14px 24px; font-size: 16px; line-height: 19px; width: 100%; max-width: 280px; } }
.expertise__empty { width: 100%; padding: 40px; text-align: center; border: 2px dashed #ccc; border-radius: 8px; background: #f9f9f9; }
.expertise__empty-text { color: #5C6D6F; font-size: 16px; font-family: "Nunito Sans Variable", "Nunito Sans", system-ui, -apple-system, sans-serif; margin: 0; }
</style>
